## Setup

### Load packages

```{r load-packages, message = FALSE}
library(dplyr)
library(ggplot2)
library(GGally)
library(statsr)
library(BAS)
library(knitr)
```

### Load data

```{r}
load("movies.Rdata")

d1<-as.data.frame(movies)

dim(d1)

```



* * *

## Part 1: Data

The data set is a randomly selected group of 651 movies produced and released between 1970 and 2014.  Since this data is observational and not related to an expirement with random assignment, we can not look for causal relationships.  However, since the movies were randomly selected, we can look for associations and apply them to the population of interest, movies produced and released for consumption in the US market.

There is little information on how the movies were randomly selected.  One might want to check to see if the composition of the the factor varialbes in the sample is representative of the total population of movies released within the date range.  There is also a potential for bias in the audience scores if we find that the populaton providing their opinions to IMDb and Rotten Tomatoes is not a good representation of the population viewing movies in the US market.


* * *

## Part 2: Data manipulation

First, I'll select the variables I'll need from the original data set, and use the mutate() function to create the new factors required for the model.

```{r}
d2<-d1 %>% 
  select(title_type, genre, runtime, mpaa_rating, thtr_rel_year,
         thtr_rel_month, imdb_rating, imdb_num_votes, critics_score,
         best_pic_nom, best_pic_win, best_actor_win, best_actress_win,
         best_dir_win, top200_box, audience_score) %>%
  mutate(feature_film=ifelse(title_type=="Feature Film", "yes", "no")) %>%
  mutate(drama=ifelse(genre=="Drama", "yes", "no")) %>%
  mutate(mpaa_rating_R=ifelse(mpaa_rating=="R", "yes", "no")) %>%
  mutate(oscar_season=ifelse(thtr_rel_month>9, "yes", "no")) %>%
  mutate(summer_season=ifelse(thtr_rel_month>4 & thtr_rel_month<9, "yes", "no"))

```

Next, I'll select only the varialbes specified for EDA and Modelling, putting the dependant variable first.

```{r}
movdat<-d2 %>%
  select(audience_score, feature_film, drama, runtime, mpaa_rating_R, thtr_rel_year,
         oscar_season, summer_season, imdb_rating, imdb_num_votes,
         critics_score, best_pic_nom, best_pic_win, best_actor_win,
         best_actress_win, best_dir_win, top200_box)
```

Finally, I will check for any observations with missing data and remove any that I find.  Then I'll look at the dimensions of the final data set.

```{r}
cc<-complete.cases(movdat)
movdat<-movdat[cc,]
na<-sum(is.na(movdat))
na
dim(movdat)
```

We see that only one record is removed and that the final data set has 650 observations of 17 variables.

* * *

## Part 3: Exploratory data analysis

Now that we have our data set, let's take a look relationships between the dependant variable (audience_score) and the numeric predictors.

First, we'll look at some summary statistics:

```{r}
edan<-select_if(movdat, is.numeric)

s1<-summary(edan$audience_score)
s2<-summary(edan$runtime)
s3<-summary(edan$thtr_rel_year)
s4<-summary(edan$imdb_rating)
s5<-summary(edan$imdb_num_votes)
s6<-summary(edan$critics_score)

stats<-names(edan)

sumtable<-as.data.frame(rbind(s1,s2,s3,s4,s5,s6))
sumtable<-as.data.frame(cbind(stats, sumtable))

sumtable<-sumtable %>%
  mutate(Skew=ifelse(Mean>Median, "Right", "Left"))

kable(sumtable)
```

Blah blah blah.

Next we'll look at a correlation matrix:

```{r}
p1<-ggpairs(edan)+
  theme(legend.position = "none", axis.text.x = element_text(angle = 60,hjust = 1))

p1

```

Blah blah blah

Now we'll evaluate the new factor varialbes we created.  We'll use summary tables, box plots and density plots.  First up is the feature_film variable.

```{r}
eda<-movdat %>%
  select(audience_score, feature_film, drama,
         mpaa_rating_R, oscar_season, summer_season)

eda1<-eda %>%
  group_by(feature_film) %>%
  summarise(n(), min(audience_score), quantile(audience_score, .25), 
            median(audience_score), mean(audience_score),
            quantile(audience_score, .75), max(audience_score))

names(eda1)<-c("FeatureFilm", "Count", "Min", "1st Qu.", "Median", "Mean",
               "3rd Qu.", "Max")
eda1<-mutate(eda1, Skew=ifelse(Mean>Median, "Right", "Left"))

kable(eda1)

p2<-ggplot(eda, aes(x=factor(feature_film), y=audience_score, fill=factor(feature_film)))+
  geom_boxplot()+
  theme(legend.position = "none", axis.text.x = element_text(angle = 60,hjust = 1))+
  ggtitle("Audience Score Box Plot")+
  labs(x="Feature Film?", y="Audience Score")

mu2<-eda %>%
  group_by(feature_film) %>%
  summarise(Mean=mean(audience_score))

p2a<-ggplot(eda, aes(x=audience_score, color=feature_film, fill=feature_film))+
  geom_density()+facet_grid(feature_film~.)+
  geom_vline(data=mu2, aes(xintercept=Mean),
             linetype="dashed")+
  theme(legend.position = "right", axis.text.x = element_text(angle = 60,hjust = 1))+
  ggtitle("Audience Score Distribution")+
  labs(x="Audience Score", y="Density")

p2
p2a

```


* * *

## Part 4: Modeling

NOTE: Insert code chunks as needed by clicking on the "Insert a new code chunk" 
button above. Make sure that your code is visible in the project you submit. 
Delete this note when before you submit your work.

* * *

## Part 5: Prediction

NOTE: Insert code chunks as needed by clicking on the "Insert a new code chunk" 
button above. Make sure that your code is visible in the project you submit. 
Delete this note when before you submit your work.

* * *

## Part 6: Conclusion

